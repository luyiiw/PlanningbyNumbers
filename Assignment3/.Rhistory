filter(race != 9, candidate != 0, income != 0, religion != 0, !education %in% c(8, 9), !party %in% c(3,4,8, 9), !age <=17, gender= !3) %>%
mutate(
race_cat = as.factor(recode(race,
`1` = "white",
`2` = "black",
`3` = "other",
`4` = "other",
`5` = "Hispanic",
`6` = "other")),
candidate_cat=as.factor(recode(candidate,
`1` = "Democrat",
`2` = "Republican")),
income_cat=as.factor(recode(income,
`1`= "lower income",
`2`= "lower income",
`3`= "middle income",
`4`= "high income",
`5`= "high income")),
religion_cat=as.factor(recode(religion,
`1`="Protestant",
`2`="Catholic",
`3`="Jewish",
`4`="Other")),
education_cat=as.factor(recode(education,
`1` = "Below HS",
`2` = "Below HS",
`3` = "HS",
`4` = "HS",
`5` = "Some College",
`6` = "BS Degree",
`7` = "Graduate Degree")),
party_cat=as.factor(recode(party,
`1` = "Republican",
`2` = "Independent",
`5` = "Democrat")),
gender_cat=as.factor(recode(gender,
`1`="Male",
`2`="Female")))%>%
select(-candidate,-income,-religion,-education,-party,-race,-gender)
dat01 <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
rename(candidate = VCF0704a, income=VCF0114, year = VCF0004, religion=VCF0128, education=VCF0140a, party=VCF0302, race = VCF0105a, age=VCF0101, gender=VCF0104) %>%
select(year, candidate, income, year, religion, education, party, race, age, gender) %>%
filter(race != 9, candidate != 0, income != 0, religion != 0, !education %in% c(8, 9), !party %in% c(3,4,8, 9), !age <=17, gender !=3) %>%
mutate(
race_cat = as.factor(recode(race,
`1` = "white",
`2` = "black",
`3` = "other",
`4` = "other",
`5` = "Hispanic",
`6` = "other")),
candidate_cat=as.factor(recode(candidate,
`1` = "Democrat",
`2` = "Republican")),
income_cat=as.factor(recode(income,
`1`= "lower income",
`2`= "lower income",
`3`= "middle income",
`4`= "high income",
`5`= "high income")),
religion_cat=as.factor(recode(religion,
`1`="Protestant",
`2`="Catholic",
`3`="Jewish",
`4`="Other")),
education_cat=as.factor(recode(education,
`1` = "Below HS",
`2` = "Below HS",
`3` = "HS",
`4` = "HS",
`5` = "Some College",
`6` = "BS Degree",
`7` = "Graduate Degree")),
party_cat=as.factor(recode(party,
`1` = "Republican",
`2` = "Independent",
`5` = "Democrat")),
gender_cat=as.factor(recode(gender,
`1`="Male",
`2`="Female")))%>%
select(-candidate,-income,-religion,-education,-party,-race,-gender)
dat2012 <- dat01 %>% filter (year==2012)
dat2016 <- dat01 %>% filter (year==2016)
mod.1 <- glm(candidate_cat ~ age + race_cat + gender_cat+
income_cat + religion_cat +
education_cat + party_cat,
data = dat2012,
na.action = na.exclude,
family = binomial("logit"))
summary(mod.1)
summary(mod.1)
View(dat2012)
View(dat01)
dat02 <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
rename(candidate = VCF0704a, income=VCF0114, year = VCF0004, religion=VCF0128, education=VCF0140a, party=VCF0302, race = VCF0105a, age=VCF0101, gender=VCF0104) %>%
select(year, candidate, income, year, religion, education, party, race, age, gender) %>%
filter(race != 9, candidate != 0, income != 0, religion != 0, !education %in% c(8, 9), !party %in% c(3,4,8, 9), !age <=17, gender !=3) %>%
mutate(
race_cat = as.factor(recode(race,
`1` = "white",
`2` = "black",
`3` = "other",
`4` = "other",
`5` = "Hispanic",
`6` = "other")),
candidate_cat=as.factor(recode(candidate,
`1` = "Democrat",
`2` = "Republican")),
income_cat=as.factor(recode(income,
`1`= "lower income",
`2`= "lower income",
`3`= "middle income",
`4`= "high income",
`5`= "high income")),
religion_cat=as.factor(recode(religion,
`1`="Protestant",
`2`="Catholic",
`3`="Jewish",
`4`="Other")),
education_cat=as.factor(recode(education,
`1` = "Below HS",
`2` = "Below HS",
`3` = "HS",
`4` = "HS",
`5` = "Some College",
`6` = "BS Degree",
`7` = "Graduate Degree")),
party_cat=as.factor(recode(party,
`1` = "Republican",
`2` = "Independent",
`5` = "Democrat")),
gender_cat=as.factor(recode(gender,
`1`="Male",
`2`="Female")),
age_cat=case_when(
age >= 17 & age <= 24 ~ "17-24",
age >= 25 & age <= 34 ~ "25-34",
age >= 35 & age <= 44 ~ "35-44",
age >= 45 & age <= 59 ~ "45-59",
age >= 60            ~ "60+" ))%>%
select(-candidate,-income,-religion,-education,-party,-race,-gender,-age)
library(haven)
library(arm)
library(tidyverse)
dat02 <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
rename(candidate = VCF0704a, income=VCF0114, year = VCF0004, religion=VCF0128, education=VCF0140a, party=VCF0302, race = VCF0105a, age=VCF0101, gender=VCF0104) %>%
select(year, candidate, income, year, religion, education, party, race, age, gender) %>%
filter(race != 9, candidate != 0, income != 0, religion != 0, !education %in% c(8, 9), !party %in% c(3,4,8, 9), !age <=17, gender !=3) %>%
mutate(
race_cat = as.factor(recode(race,
`1` = "white",
`2` = "black",
`3` = "other",
`4` = "other",
`5` = "Hispanic",
`6` = "other")),
candidate_cat=as.factor(recode(candidate,
`1` = "Democrat",
`2` = "Republican")),
income_cat=as.factor(recode(income,
`1`= "lower income",
`2`= "lower income",
`3`= "middle income",
`4`= "high income",
`5`= "high income")),
religion_cat=as.factor(recode(religion,
`1`="Protestant",
`2`="Catholic",
`3`="Jewish",
`4`="Other")),
education_cat=as.factor(recode(education,
`1` = "Below HS",
`2` = "Below HS",
`3` = "HS",
`4` = "HS",
`5` = "Some College",
`6` = "BS Degree",
`7` = "Graduate Degree")),
party_cat=as.factor(recode(party,
`1` = "Republican",
`2` = "Independent",
`5` = "Democrat")),
gender_cat=as.factor(recode(gender,
`1`="Male",
`2`="Female")),
age_cat=case_when(
age >= 17 & age <= 24 ~ "17-24",
age >= 25 & age <= 34 ~ "25-34",
age >= 35 & age <= 44 ~ "35-44",
age >= 45 & age <= 59 ~ "45-59",
age >= 60            ~ "60+" ))%>%
select(-candidate,-income,-religion,-education,-party,-race,-gender,-age)
View(dat02)
dat201201<-dat02 %>% filter (year==2012)
dat201601 <- dat02 %>% filter (year==2016)
mod.11 <- glm(candidate_cat ~ age_cat + race_cat + gender_cat+
income_cat + religion_cat +
education_cat + party_cat,
data = dat201201,
na.action = na.exclude,
family = binomial("logit"))
summary(mod.11)
summary(mod.1)
rm(list = ls())
library(haven)
library(arm)
library(tidyverse)
load("cpln505_assignment3_voting_data_abb.rda")
dat02 <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
rename(candidate = VCF0704a, income=VCF0114, year = VCF0004, religion=VCF0128, education=VCF0140a, party=VCF0302, race = VCF0105a, age=VCF0101, gender=VCF0104) %>%
select(year, candidate, income, year, religion, education, party, race, age, gender) %>%
filter(race != 9, candidate != 0, income != 0, religion != 0, !education %in% c(8, 9), !party %in% c(3,4,8, 9), !age <=17, gender !=3) %>%
mutate(
race_cat = as.factor(recode(race,
`1` = "white",
`2` = "black",
`3` = "other",
`4` = "other",
`5` = "Hispanic",
`6` = "other")),
candidate_cat=as.factor(recode(candidate,
`1` = "Democrat",
`2` = "Republican")),
income_cat=as.factor(recode(income,
`1`= "lower income",
`2`= "lower income",
`3`= "middle income",
`4`= "high income",
`5`= "high income")),
religion_cat=as.factor(recode(religion,
`1`="Protestant",
`2`="Catholic",
`3`="Jewish",
`4`="Other")),
education_cat=as.factor(recode(education,
`1` = "Below HS",
`2` = "Below HS",
`3` = "HS",
`4` = "HS",
`5` = "Some College",
`6` = "BS Degree",
`7` = "Graduate Degree")),
party_cat=as.factor(recode(party,
`1` = "Republican",
`2` = "Independent",
`5` = "Democrat")),
gender_cat=as.factor(recode(gender,
`1`="Male",
`2`="Female")),
age_cat=case_when(
age >= 17 & age <= 24 ~ "17-24",
age >= 25 & age <= 34 ~ "25-34",
age >= 35 & age <= 44 ~ "35-44",
age >= 45 & age <= 59 ~ "45-59",
age >= 60            ~ "60+" ))%>%
select(-candidate,-income,-religion,-education,-party,-race,-gender,-age)
dat02 <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
rename(candidate = VCF0704a, income=VCF0114, year = VCF0004, religion=VCF0128, education=VCF0140a, party=VCF0302, race = VCF0105a, age=VCF0101, gender=VCF0104) %>%
select(year, candidate, income, year, religion, education, party, race, age, gender) %>%
filter(race != 9, candidate != 0, income != 0, religion != 0, !education %in% c(8, 9), !party %in% c(3,4,8, 9), !age <=17, !gender %in% c(0,3)) %>%
mutate(
race_cat = as.factor(recode(race,
`1` = "white",
`2` = "black",
`3` = "other",
`4` = "other",
`5` = "Hispanic",
`6` = "other")),
candidate_cat=as.factor(recode(candidate,
`1` = "Democrat",
`2` = "Republican")),
income_cat=as.factor(recode(income,
`1`= "lower income",
`2`= "lower income",
`3`= "middle income",
`4`= "high income",
`5`= "high income")),
religion_cat=as.factor(recode(religion,
`1`="Protestant",
`2`="Catholic",
`3`="Jewish",
`4`="Other")),
education_cat=as.factor(recode(education,
`1` = "Below HS",
`2` = "Below HS",
`3` = "HS",
`4` = "HS",
`5` = "Some College",
`6` = "BS Degree",
`7` = "Graduate Degree")),
party_cat=as.factor(recode(party,
`1` = "Republican",
`2` = "Independent",
`5` = "Democrat")),
gender_cat=as.factor(recode(gender,
`1`="Male",
`2`="Female")),
age_cat=case_when(
age >= 17 & age <= 24 ~ "17-24",
age >= 25 & age <= 34 ~ "25-34",
age >= 35 & age <= 44 ~ "35-44",
age >= 45 & age <= 59 ~ "45-59",
age >= 60            ~ "60+" ))%>%
select(-candidate,-income,-religion,-education,-party,-race,-gender,-age)
library(dplyr)
library(tidyr)
library(ggplot)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot)
dat201201<-dat02 %>% filter (year==2012)
dat201601 <- dat02 %>% filter (year==2016)
mod.11 <- glm(candidate_cat ~ age_cat + race_cat + gender_cat+
income_cat + religion_cat +
education_cat + party_cat,
data = dat201201,
na.action = na.exclude,
family = binomial("logit"))
summary(mod.11)
View(dat02)
ggplot(dat02, aes(x = year, fill = income_cat)) +
geom_bar(position = "dodge") +
labs(title = "Count of People in Each\nIncome Group by Transit Mode",
x = "Income Group",
y = "Count",
fill = "Transit Mode",
caption = "Figure 2.1")+
theme_minimal()
ggplot(dat02, aes(x = year, fill = age_cat)) +
geom_bar(position = "dodge") +
labs(title = "Count of People in Each\nIncome Group by Transit Mode",
x = "Income Group",
y = "Count",
fill = "Transit Mode",
caption = "Figure 2.1")+
theme_minimal()
ggplot(dat02, aes(x = year, fill = age_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each\nIncome Group by Transit Mode",
x = "Income Group",
y = "Count",
fill = "Transit Mode",
caption = "Figure 2.1")+
theme_minimal()
ggplot(dat02, aes(x = year, fill = age_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each\nIncome Group by Transit Mode",
x = "Income Group",
y = "Count",
fill = "Transit Mode",
caption = "Figure 2.1")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = age_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each\nAge Group by Year",
x = "Age Group",
y = "Count",
fill = "Age Group",
caption = "Figure 1.1")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = age_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Age Group by Year",
x = "Age Group",
y = "Count",
fill = "Age Group",
caption = "Figure 1.1")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = race_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Race Group by Year",
x = "Race Group",
y = "Count",
fill = "Race Group",
caption = "Figure 1.1")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
dat02 <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
rename(candidate = VCF0704a, income=VCF0114, year = VCF0004, religion=VCF0128, education=VCF0140a, party=VCF0302, race = VCF0105a, age=VCF0101, gender=VCF0104) %>%
select(year, candidate, income, year, religion, education, party, race, age, gender) %>%
filter(race != 9, candidate != 0, income != 0, religion != 0, !education %in% c(8, 9), !party %in% c(3,4,8, 9), !age <=17, !gender %in% c(0,3)) %>%
mutate(
race_cat = as.factor(recode(race,
`1` = "White",
`2` = "Black",
`3` = "other",
`4` = "other",
`5` = "Hispanic",
`6` = "other")),
candidate_cat=as.factor(recode(candidate,
`1` = "Democrat",
`2` = "Republican")),
income_cat=as.factor(recode(income,
`1`= "lower income",
`2`= "lower income",
`3`= "middle income",
`4`= "high income",
`5`= "high income")),
religion_cat=as.factor(recode(religion,
`1`="Protestant",
`2`="Catholic",
`3`="Jewish",
`4`="Other")),
education_cat=as.factor(recode(education,
`1` = "Below HS",
`2` = "Below HS",
`3` = "HS",
`4` = "HS",
`5` = "Some College",
`6` = "BS Degree",
`7` = "Graduate Degree")),
party_cat=as.factor(recode(party,
`1` = "Republican",
`2` = "Independent",
`5` = "Democrat")),
gender_cat=as.factor(recode(gender,
`1`="Male",
`2`="Female")),
age_cat=case_when(
age >= 17 & age <= 24 ~ "17-24",
age >= 25 & age <= 34 ~ "25-34",
age >= 35 & age <= 44 ~ "35-44",
age >= 45 & age <= 59 ~ "45-59",
age >= 60            ~ "60+" ))%>%
select(-candidate,-income,-religion,-education,-party,-race,-gender,-age)
ggplot(dat02, aes(x = year, fill = race_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Race Group by Year",
x = "Race Group",
y = "Count",
fill = "Race Group",
caption = "Figure 1.1")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = gender_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Gender Group by Year",
x = "Gender Group",
y = "Count",
fill = "Gender Group",
caption = "Figure 1.2")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = age_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Age Group by Year",
x = "Age Group",
y = "Count",
fill = "Age Group",
caption = "Figure 1.3")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = age_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Household income Group by Year",
x = "Household Income Group",
y = "Count",
fill = "Household Income Group",
caption = "Figure 1.4")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
###Year by Household Income###
ggplot(dat02, aes(x = year, fill = income_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Household income Group by Year",
x = "Household Income Group",
y = "Count",
fill = "Household Income Group",
caption = "Figure 1.4")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = religion_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Each Religion Group by Year",
x = "Religion Group",
y = "Count",
fill = "Religion Group",
caption = "Figure 1.5")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = religion_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Educational attainment  by Year",
x = "Educational Attainment",
y = "Count",
fill = "Educational Attainment",
caption = "Figure 1.6")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
###Year by Education###
ggplot(dat02, aes(x = year, fill = education_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Educational attainment  by Year",
x = "Educational Attainment",
y = "Count",
fill = "Educational Attainment",
caption = "Figure 1.6")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
ggplot(dat02, aes(x = year, fill = party_cat)) +
geom_bar(position = "dodge", stat="count") +
labs(title = "Count of People in Party Affiliation by Year",
x = "Party Affiliation",
y = "Count",
fill = "Party Affiliation",
caption = "Figure 1.7")+
scale_x_continuous(breaks = c(2012, 2016), labels = c("2012", "2016")) + # Set x-axis breaks
theme_minimal()
