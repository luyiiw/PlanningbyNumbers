rm(list = ls())
library(haven)
library(arm)
rm(list = ls())
install.packages("arm")
library(haven)
library(arm)
library(tidyverse)
load("cpln505_assignment3_voting_data_abb.rda")
dat <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
rename(candidate = VCF0704a, year = VCF0004, race = VCF0105a) %>%
select(year, candidate, race) %>%
filter(race != 9, candidate != 0) %>%
mutate(race_cat = as.factor(recode(race,
`1` = "white",
`2` = "black",
`3` = "other",
`4` = "other",
`5` = "other",
`6` = "other")))
rm(list = ls())
library(tidyverse)
read.csv("C:\Users\USER\Desktop\PlanningByNumbers\Assignment03\publicdb_release\DVRPC HTS Database Files\4_Trip_Public.csv")
read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\4_Trip_Public.csv")
read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\4_Trip_Public.csv")
Trip_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\4_Trip_Public.csv")
View(Trip_public)
Person_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\2_Person_Public.csv")
Household_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\1_Household_Public.csv")
library(dplyr)
filtered_trips <-Trip_public %>%
filter(MODE_AGG %in% c(2, 3, 5) & D_LOC_TYPE == 2)
View(filtered_trips)
filtered_trips <- filtered_trips %>%
mutate(mode = case_when(
MODE_AGG == 2 ~ "bike",
MODE_AGG == 3 ~ "car",
MODE_AGG == 5 ~ "transit"
))
View(filtered_trips)
first_work_trips <- filtered_trips %>%
arrange(ID, TRIP_ID) %>%
group_by(ID) %>%
slice(1) %>%
ungroup()
first_work_trips <- filtered_trips %>%
arrange(ID, TRIP_NUM) %>%
group_by(ID) %>%
slice(1) %>%
ungroup()
first_work_trips <- filtered_trips %>%
arrange(ID, TRIP_NUM) %>%
group_by(ID) %>%
slice(1) %>%
ungroup()
first_work_trips <- filtered_trips %>%
arrange(ID, TRIP_NUM) %>%
group_by(ID) %>%
slice(1) %>%
ungroup()
View(Trip_public)
rm(list = ls())
library(tidyverse)
library(dplyr)
Trip_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\4_Trip_Public.csv")
filtered_trips <-Trip_public %>%
filter(MODE_AGG %in% c(2, 3, 5) & D_LOC_TYPE == 2)
View(filtered_trips)
filtered_trips<-filtered_trips%>%
mutate(transit_mode=as.factor(
recode(MODE_AGG,
'2'="bike",
'3'="car",
'5'="transit")))
View(filtered_trips)
View(filtered_trips)
filtered_trips<-filtered_trips%>%
filter(TRIP_NUM == 1)
Person_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\2_Person_Public.csv")
View(Person_public)
Household_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\1_Household_Public.csv")
rm(list = ls())
install.packages("arm")
library(haven)
library(arm)
library(tidyverse)
load("cpln505_assignment3_voting_data_abb.rda")
View(dat.voting)
Person_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\2_Person_Public.csv")
person.dat <- Person_public %>%
select(HH_ID, PERSON_ID, EDUCA, LIC, EMPLY, WK_MODE, PARK_SUB, TRAN_SUB)
library(tidyverse)
library(dplyr)
person.dat <- Person_public %>%
select(HH_ID, PERSON_ID, EDUCA, LIC, EMPLY, WK_MODE, PARK_SUB, TRAN_SUB)
View(Person_public)
(list = ls())
rm(list = ls())
library(tidyverse)
library(dplyr)
Person_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\2_Person_Public.csv")
View(Person_public)
person.dat <- Person_public %>%
select(HH_ID, PERSON_ID, EDUCA, LIC, EMPLY, WK_MODE, PARK_SUB, TRAN_SUB)
person.dat <- Person_public %>%
dplyr::select(HH_ID, PERSON_ID, EDUCA, LIC, EMPLY, WK_MODE, PARK_SUB, TRAN_SUB)
person.dat <- na.omit(person.dat)
person.dat <- person.dat[!(person.dat$EDUCA %in% "99"),]
person.dat <- person.dat[!(person.dat$EDUCA %in% "98"),]
person.dat <- person.dat[!(person.dat$LIC %in% "99"),]
person.dat <- person.dat[!(person.dat$LIC %in% "98"),]
View(person.dat)
rm(list = ls())
library(haven)
library(arm)
library(tidyverse)
load("cpln505_assignment3_voting_data_abb.rda")
dat <- dat.voting %>% filter(VCF0004 == 2012 | VCF0004 == 2016) %>%
Person_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\2_Person_Public.csv")
rm(list = ls())
library(tidyverse)
library(dplyr)
Trip_public<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\4_Trip_Public.csv")
View(Trip_public)
rm(list = ls())
library(tidyverse)
trip.dat<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\4_Trip_Public.csv")
person.dat<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\2_Person_Public.csv")
household.dat<-read.csv("C:\\Users\\USER\\Desktop\\PlanningByNumbers\\Assignment03\\publicdb_release\\DVRPC HTS Database Files\\1_Household_Public.csv")
trip.dat <- trip.dat %>%
filter(MODE_AGG %in% c(2, 3, 5) & D_LOC_TYPE == 2)
trip.dat <- trip.dat %>%
mutate(tranist_mode = as.factor(
recode(MODE_AGG,
`2` = "bike",
`3` = "car",
`5` = "transit")))
trip.dat <- trip.dat %>%
filter(TRIP_NUM == 1)
trip.dat <- trip.dat %>%
select(HH_ID, PERSON_ID, Model_TravTime, Model_TravDist)
person.dat <- person.dat %>%
select(HH_ID, PERSON_ID, EDUCA, LIC, WK_MODE, PARK_SUB, TRAN_SUB)
person.dat <- na.omit(person.dat)
person.dat <- person.dat[!(person.dat$EDUCA %in% "99"),]
person.dat <- person.dat[!(person.dat$EDUCA %in% "98"),]
person.dat <- person.dat[!(person.dat$LIC %in% "99"),]
person.dat <- person.dat[!(person.dat$LIC %in% "98"),]
## removing odd data and refused answer for WORK_MODE
person.dat <- person.dat[!(person.dat$WK_MODE %in% "0"),]
person.dat <- person.dat[!(person.dat$WK_MODE %in% "9"),]
## removing don't know and refused answer for PARK_SUB
person.dat <- person.dat[!(person.dat$PARK_SUB %in% "8"),]
person.dat <- person.dat[!(person.dat$PARK_SUB %in% "9"),]
## removing don't know and refused answer for TRAN_SUB
person.dat <- person.dat[!(person.dat$TRAN_SUB %in% "8"),]
person.dat <- person.dat %>%
mutate(education = as.factor(
recode(EDUCA,
`1` = "Below HS",
`2` = "HS Grad",
`3` = "Some College",
`4` = "Associate Degree",
`5` = "BS Degree",
`6` = "Graduate Degree",
`97` = "Other"))) %>%
mutate(driver_license = as.factor(
recode(LIC,
`1` = "Yes",
`2` = "No"))) %>%
mutate(transit_mode = as.factor(
recode(WK_MODE,
`1` = "Car",
`2` = "Carpool",
`3` = "Car and Transit",
`4` = "Tranist",
`5` = "Bicylce",
`6` = "Walking",
`7` = "Other",
`8` = "WFH"))) %>%
mutate(parking_subsidy = as.factor(
recode(PARK_SUB,
`1` = "Subsidized Parking",
`2` = "No Parking Subsidy",
`3` = "Free Parking"))) %>%
mutate(transit_subsidy = as.factor(
recode(TRAN_SUB,
`1` = "Subsidized Transit",
`2` = "No Transit Subsidy")))
person.dat <- person.dat %>%
select(HH_ID, PERSON_ID, education, driver_license, transit_mode, parking_subsidy, transit_subsidy)
household.dat <- household.dat %>%
select(HH_ID, H_COUNTY, A_TYPE, HH_SIZE, TOT_VEH, TOLL_ACCNT, INCOME)
#step 2. for each variable, remove meaningless values
## removing NA rows
household.dat <- na.omit(household.dat)
## removing TOLL_ACCNT don't know rows
household.dat <- household.dat[!(household.dat$TOLL_ACCNT %in% "98"),]
## removing INCOME don't know or refused rows
household.dat <- household.dat[!(household.dat$INCOME %in% "98"),]
household.dat <- household.dat[!(household.dat$INCOME %in% "99"),]
#step 3. recode values to more sensible categories
household.dat <- household.dat %>%
mutate(county = as.factor(
recode(H_COUNTY,
`42017` = "Bucks",
`42029` = "Chester",
`42045` = "Delaware",
`42091` = "Montgomery",
`42101` = "Philadelphia",
`34005` = "Burlington",
`34007` = "Camden",
`34015` = "Gloucester",
`34021` = "Mercer"))) %>%
mutate(area_type = as.factor(
recode(A_TYPE,
`1` = "CBD",
`2` = "CBD Fringe",
`3` = "Urban",
`4` = "Surburban",
`5` = "Rural",
`6` = "Open Rural")))
## renaming columns
household.dat <- household.dat %>%
rename(household_size = HH_SIZE) %>%
rename(total_veh = TOT_VEH) %>%
rename(toll_account = TOLL_ACCNT)
## re categorizing income
household.dat <- household.dat %>%
mutate(hh_income = case_when(
INCOME == '1' ~ 'low_income',
INCOME == '2' ~ 'low_income',
INCOME == '3' ~ 'low_income',
INCOME == '4' ~ 'low_income',
INCOME == '5' ~ 'middle_income',
INCOME == '6' ~ 'middle_income',
INCOME == '7' ~ 'middle_income',
INCOME >= '8' ~ 'high_income'))
#step 4. select only the relevant variables
household.dat <- household.dat %>%
select(-H_COUNTY, -A_TYPE, -INCOME)
View(person.dat)
View(trip.dat)
library(haven)
library(arm)
library(tidyverse)
dat <- merge(trip.dat, person.dat, by = "HH_ID", all.x = FALSE, all.y=FALSE, sort = FALSE)
dat <- merge(household.dat, dat, by = "HH_ID", all.x = FALSE, all.y=FALSE, sort = FALSE)
View(dat)
dat <- dat %>%
filter(Model_TravDist < 10,
Model_TravTime < 120)
#step 3. remove NAs. if this step leaves you with a few observations (say, a few hundred), then inspect variables to see
any(is.na(dat))
which(is.na(dat), arr.ind = TRUE)
sum(is.na(dat))
